"use strict";(self.webpackChunkwhk_wiki=self.webpackChunkwhk_wiki||[]).push([["840"],{63494:function(n,e,t){t.r(e),t.d(e,{frontMatter:()=>a,toc:()=>p,default:()=>c,metadata:()=>i,assets:()=>d,contentTitle:()=>s});var i=JSON.parse('{"id":"intro/book","title":"\u6559\u6750\u7535\u5B50\u4E66\u4E0B\u8F7D","description":"\u7B14\u8005\u5B8C\u6210\u4E86\u4E00\u4E2A\u5C06\u7535\u5B50\u4E66\u4ECE\u4EBA\u6559\u7248\u5B98\u7F51\u4E0A\u4E0B\u8F7D\uFF0C\u5E76\u4E14\u81EA\u52A8\u5C06\u56FE\u7247\u5408\u6210\u4E3A\u4E00\u4E2A pdf \u7684 python \u811A\u672C\uFF0C\u4F1A\u653E\u5728\u672C\u6587\u7684\u6700\u540E\uFF0E\u4E0B\u9762\u662F\u811A\u672C\u7684\u4F7F\u7528\u65B9\u6CD5\u4E0E\u6CE8\u610F\u4E8B\u9879\uFF1A","source":"@site/docs/intro/book.md","sourceDirName":"intro","slug":"/intro/book","permalink":"/whk-wiki/intro/book","draft":false,"unlisted":false,"editUrl":"https://github.com/whk-wiki/whk-wiki/tree/main/docs/intro/book.md","tags":[],"version":"current","lastUpdatedBy":"dbxxx-oi","lastUpdatedAt":1701394043000,"sidebarPosition":4,"frontMatter":{"sidebar_position":4},"sidebar":"introSidebar","previous":{"title":"\u683C\u5F0F\u624B\u518C","permalink":"/whk-wiki/intro/format"}}'),o=t(85893),r=t(50065);let a={sidebar_position:4},s="\u6559\u6750\u7535\u5B50\u4E66\u4E0B\u8F7D",d={},p=[];function l(n){let e={code:"code",h1:"h1",header:"header",p:"p",pre:"pre",...(0,r.a)(),...n.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e.header,{children:(0,o.jsx)(e.h1,{id:"\u6559\u6750\u7535\u5B50\u4E66\u4E0B\u8F7D",children:"\u6559\u6750\u7535\u5B50\u4E66\u4E0B\u8F7D"})}),"\n",(0,o.jsx)(e.p,{children:"\u7B14\u8005\u5B8C\u6210\u4E86\u4E00\u4E2A\u5C06\u7535\u5B50\u4E66\u4ECE\u4EBA\u6559\u7248\u5B98\u7F51\u4E0A\u4E0B\u8F7D\uFF0C\u5E76\u4E14\u81EA\u52A8\u5C06\u56FE\u7247\u5408\u6210\u4E3A\u4E00\u4E2A pdf \u7684 python \u811A\u672C\uFF0C\u4F1A\u653E\u5728\u672C\u6587\u7684\u6700\u540E\uFF0E\u4E0B\u9762\u662F\u811A\u672C\u7684\u4F7F\u7528\u65B9\u6CD5\u4E0E\u6CE8\u610F\u4E8B\u9879\uFF1A"}),"\n",(0,o.jsxs)(e.p,{children:["\u4ECE\u672C\u6587\u7684\u6700\u540E\u590D\u5236\u811A\u672C\u4E3A ",(0,o.jsx)(e.code,{children:"download.py"}),"\uFF0C\u8FD0\u884C ",(0,o.jsx)(e.code,{children:"python download.py [name]"}),"\uFF0C",(0,o.jsx)(e.code,{children:"[name]"})," \u586B\u5165\u4F60\u60F3\u8981\u4E0B\u8F7D\u7684\u6559\u6750\u4EE3\u53F7\uFF0E"]}),"\n",(0,o.jsxs)(e.p,{children:["\u8FD0\u884C\u8BE5\u811A\u672C\u9700\u8981\u5B89\u88C5 pillow \u5E93\uFF0C\u5B89\u88C5\u65B9\u6CD5\u4E3A ",(0,o.jsx)(e.code,{children:"pip install -i https://pypi.tuna.tsinghua.edu.cn/simple Pillow"}),"\uFF0E"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-python",metastring:'title="download.py"',children:"import os, sys, requests\nfrom PIL import Image\n\ndef download(file_path, picture_url) -> bool:\n	headers = {\n		\"User-Agent\": \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 			(KHTML, like Gecko) Chrome/63.0.3239.132 Safari/537.36 QIHU 360SE\",\n	}\n	r = requests.get(picture_url, headers=headers)\n	if r.content == b'':\n		return False\n	with open(file_path, 'wb') as f:\n		f.write(r.content)\n	return True\n\nids = {\n	'math-xxa2': '1421001138232',\n	'math-xxa3': '1421001138233',\n	'math-xxb4': '1421001138237',\n}\n\ndef main(name: str) -> None:\n	name = name.lower()\n	os.makedirs(f'./{name}/', exist_ok=True)  # \u8F93\u51FA\u76EE\u5F55\n	id = ids[name]\n	if id == None:\n		print('Error: Can\\'t find book ' + name)\n		return\n\n	print('Start downloading book ' + name + ' with id ' + id)\n	prefix = f'https://book.pep.com.cn/{id}/files/mobile/'\n	n = 0\n	while True:\n		file_path = f'./{name}/{n + 1}.jpg'\n		picture_url = prefix + str(n + 1) + f'.jpg'\n		if not download(file_path, picture_url):\n			break\n		print(f'Page {n + 1} from {picture_url} is downloaded')\n		n = n + 1\n\n	print(f'All downloaded! {n} pages in total')\n	print('Now combine them to a pdf')\n\n	output = Image.open(f'./{name}/1.jpg')\n	output = output.convert('RGB')\n\n	sources = []\n	for i in range(2, n + 1):\n		img = Image.open(f'./{name}/{i}.jpg')\n		if img.mode == 'RGBA':\n			img = img.convert('RGB')\n		sources.append(img)\n\n	output.save(f'./{name}/{name}.pdf', 'pdf', save_all=True, append_images = sources)\n	print(f'Combine to pdf ./{name}/{name}.pdf done')\n\nif __name__ == '__main__':\n	main(sys.argv[1])\n"})})]})}function c(n={}){let{wrapper:e}={...(0,r.a)(),...n.components};return e?(0,o.jsx)(e,{...n,children:(0,o.jsx)(l,{...n})}):l(n)}},50065:function(n,e,t){t.d(e,{Z:()=>s,a:()=>a});var i=t(67294);let o={},r=i.createContext(o);function a(n){let e=i.useContext(r);return i.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function s(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(o):n.components||o:a(n.components),i.createElement(r.Provider,{value:e},n.children)}}}]);