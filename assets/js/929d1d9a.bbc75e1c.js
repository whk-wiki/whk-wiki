"use strict";(self.webpackChunkwhk_wiki=self.webpackChunkwhk_wiki||[]).push([[9048],{32391:(n,t,e)=>{e.r(t),e.d(t,{assets:()=>d,contentTitle:()=>s,default:()=>c,frontMatter:()=>a,metadata:()=>o,toc:()=>p});const o=JSON.parse('{"id":"intro/book","title":"\u6559\u6750\u7535\u5b50\u4e66\u4e0b\u8f7d","description":"\u7b14\u8005\u5b8c\u6210\u4e86\u4e00\u4e2a\u5c06\u7535\u5b50\u4e66\u4ece\u4eba\u6559\u7248\u5b98\u7f51\u4e0a\u4e0b\u8f7d\uff0c\u5e76\u4e14\u81ea\u52a8\u5c06\u56fe\u7247\u5408\u6210\u4e3a\u4e00\u4e2a pdf \u7684 python \u811a\u672c\uff0c\u4f1a\u653e\u5728\u672c\u6587\u7684\u6700\u540e\uff0e\u4e0b\u9762\u662f\u811a\u672c\u7684\u4f7f\u7528\u65b9\u6cd5\u4e0e\u6ce8\u610f\u4e8b\u9879\uff1a","source":"@site/docs/intro/book.md","sourceDirName":"intro","slug":"/intro/book","permalink":"/whk-wiki/intro/book","draft":false,"unlisted":false,"editUrl":"https://github.com/whk-wiki/whk-wiki/tree/main/docs/intro/book.md","tags":[],"version":"current","lastUpdatedBy":"dbxxx-oi","lastUpdatedAt":1701394043000,"sidebarPosition":4,"frontMatter":{"sidebar_position":4},"sidebar":"introSidebar","previous":{"title":"\u683c\u5f0f\u624b\u518c","permalink":"/whk-wiki/intro/format"}}');var i=e(74848),r=e(28453);const a={sidebar_position:4},s="\u6559\u6750\u7535\u5b50\u4e66\u4e0b\u8f7d",d={},p=[];function l(n){const t={code:"code",h1:"h1",header:"header",p:"p",pre:"pre",...(0,r.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"\u6559\u6750\u7535\u5b50\u4e66\u4e0b\u8f7d",children:"\u6559\u6750\u7535\u5b50\u4e66\u4e0b\u8f7d"})}),"\n",(0,i.jsx)(t.p,{children:"\u7b14\u8005\u5b8c\u6210\u4e86\u4e00\u4e2a\u5c06\u7535\u5b50\u4e66\u4ece\u4eba\u6559\u7248\u5b98\u7f51\u4e0a\u4e0b\u8f7d\uff0c\u5e76\u4e14\u81ea\u52a8\u5c06\u56fe\u7247\u5408\u6210\u4e3a\u4e00\u4e2a pdf \u7684 python \u811a\u672c\uff0c\u4f1a\u653e\u5728\u672c\u6587\u7684\u6700\u540e\uff0e\u4e0b\u9762\u662f\u811a\u672c\u7684\u4f7f\u7528\u65b9\u6cd5\u4e0e\u6ce8\u610f\u4e8b\u9879\uff1a"}),"\n",(0,i.jsxs)(t.p,{children:["\u4ece\u672c\u6587\u7684\u6700\u540e\u590d\u5236\u811a\u672c\u4e3a ",(0,i.jsx)(t.code,{children:"download.py"}),"\uff0c\u8fd0\u884c ",(0,i.jsx)(t.code,{children:"python download.py [name]"}),"\uff0c",(0,i.jsx)(t.code,{children:"[name]"})," \u586b\u5165\u4f60\u60f3\u8981\u4e0b\u8f7d\u7684\u6559\u6750\u4ee3\u53f7\uff0e"]}),"\n",(0,i.jsxs)(t.p,{children:["\u8fd0\u884c\u8be5\u811a\u672c\u9700\u8981\u5b89\u88c5 pillow \u5e93\uff0c\u5b89\u88c5\u65b9\u6cd5\u4e3a ",(0,i.jsx)(t.code,{children:"pip install -i https://pypi.tuna.tsinghua.edu.cn/simple Pillow"}),"\uff0e"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-python",metastring:'title="download.py"',children:"import os, sys, requests\nfrom PIL import Image\n\ndef download(file_path, picture_url) -> bool:\n\theaders = {\n\t\t\"User-Agent\": \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 \t\t\t(KHTML, like Gecko) Chrome/63.0.3239.132 Safari/537.36 QIHU 360SE\",\n\t}\n\tr = requests.get(picture_url, headers=headers)\n\tif r.content == b'':\n\t\treturn False\n\twith open(file_path, 'wb') as f:\n\t\tf.write(r.content)\n\treturn True\n\nids = {\n\t'math-xxa2': '1421001138232',\n\t'math-xxa3': '1421001138233',\n\t'math-xxb4': '1421001138237',\n}\n\ndef main(name: str) -> None:\n\tname = name.lower()\n\tos.makedirs(f'./{name}/', exist_ok=True)  # \u8f93\u51fa\u76ee\u5f55\n\tid = ids[name]\n\tif id == None:\n\t\tprint('Error: Can\\'t find book ' + name)\n\t\treturn\n\n\tprint('Start downloading book ' + name + ' with id ' + id)\n\tprefix = f'https://book.pep.com.cn/{id}/files/mobile/'\n\tn = 0\n\twhile True:\n\t\tfile_path = f'./{name}/{n + 1}.jpg'\n\t\tpicture_url = prefix + str(n + 1) + f'.jpg'\n\t\tif not download(file_path, picture_url):\n\t\t\tbreak\n\t\tprint(f'Page {n + 1} from {picture_url} is downloaded')\n\t\tn = n + 1\n\n\tprint(f'All downloaded! {n} pages in total')\n\tprint('Now combine them to a pdf')\n\n\toutput = Image.open(f'./{name}/1.jpg')\n\toutput = output.convert('RGB')\n\n\tsources = []\n\tfor i in range(2, n + 1):\n\t\timg = Image.open(f'./{name}/{i}.jpg')\n\t\tif img.mode == 'RGBA':\n\t\t\timg = img.convert('RGB')\n\t\tsources.append(img)\n\n\toutput.save(f'./{name}/{name}.pdf', 'pdf', save_all=True, append_images = sources)\n\tprint(f'Combine to pdf ./{name}/{name}.pdf done')\n\nif __name__ == '__main__':\n\tmain(sys.argv[1])\n"})})]})}function c(n={}){const{wrapper:t}={...(0,r.R)(),...n.components};return t?(0,i.jsx)(t,{...n,children:(0,i.jsx)(l,{...n})}):l(n)}},28453:(n,t,e)=>{e.d(t,{R:()=>a,x:()=>s});var o=e(96540);const i={},r=o.createContext(i);function a(n){const t=o.useContext(r);return o.useMemo((function(){return"function"==typeof n?n(t):{...t,...n}}),[t,n])}function s(n){let t;return t=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:a(n.components),o.createElement(r.Provider,{value:t},n.children)}}}]);